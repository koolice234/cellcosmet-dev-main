{"version":3,"sources":["webpack://project-x/./src/scripts-1r/public-path.js","webpack://project-x/webpack/bootstrap","webpack://project-x/webpack/runtime/compat get default export","webpack://project-x/webpack/runtime/define property getters","webpack://project-x/webpack/runtime/global","webpack://project-x/webpack/runtime/hasOwnProperty shorthand","webpack://project-x/webpack/runtime/publicPath","webpack://project-x/external \"jQuery\"","webpack://project-x/./src/scripts-1r/lib/pubsub.js","webpack://project-x/./src/scripts-1r/checkout.js","webpack://project-x/./src/scripts-1r/modules/module-oneMarketing.js"],"names":["__webpack_public_path__","window","ORW","appUrl","replace","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","p","jQuery","subscribers","enableGTM","marketing","constructor","settings","marketingSettings","console","log","trackPromosViaDataLayer","customSearchEvent","dataAttributeItem","productPageSelector","cartPageSelector","signUpFormID","promoParentClass","dataAttributePromo","cartCurrency","gaEvents","add_to_cart","remove_from_cart","view_cart","begin_checkout","add_shipping_info","add_payment_info","view_item_list","view_item","view_promotion","select_promotion","add_to_wishlist","search","sign_up","dataLayerPush","eventString","ecommerceObject","dataLayer","push","ecommerce","event","initCartWatchers","timer","$","on","removeFromCart","currentTarget","clearTimeout","setTimeout","checkItemQtyChangeCart","initVariantWatcher","productCore","eventName","callback","variant","newVariant","id","find","data","initWishlistWatcher","body","addToWishlist","target","initPromoWatchers","each","index","promo","__parseItemJSON","$promoParent","parent","hasClick","viewPromo","addClass","clickTarget","selectPromo","gaEvent","one","preventDefault","__triggerButtonOrLink","viewItem","itemData","__getItemDataFromJSON","__createEcommerceObjectFromItem","eventTarget","$productCore","parents","viewItemList","collection","items","itemListID","itemListName","itemsArray","__createListItemsArray","searchQuery","utilities","getUrlParam","href","item_list_id","item_list_name","query","search_term","signUp","method","accountForm","form","attr","$clickedItem","value","viewCart","cart","__getCart","__createEcommerceObjectFromCart","input","diff","__preferNumber","defaultValue","quantity","Math","abs","checkItemQtyManualChangeCartPage","quantityInputs","itemsAdded","itemsRemoved","totalValueAdded","totalValueRemoved","item","itemQuantity","val","qtyDiff","valueChange","price","addToCart","$formQtyInput","checkoutEvents","checkoutTriggers","Shopify","Checkout","currentStep","step","coupon","html","cartResponse","cartContents","fetch","error","ok","json","jsonData","__getItemJSON","parsedData","formattedData","variantID","__getProductInfo","__getItemInfo","jsonInner","jsonParsed","JSON","parse","$itemJSON","priceFormatted","__formatPrice","total_price","currency","__createCartItemsArray","final_price","discountFormatted","line_level_total_discount","coupons","__getItemCoupons","sku","product_title","vendor","product_type","variant_title","selling_plan_allocation_selling_plan_name","product","prodVariant","variants","title","type","newProduct","classList","contains","__zeroBasedIndex","discounts","line_level_discount_allocations","couponName","discount_application","trim","join","targetLink","children","click","Number"],"mappings":"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","file":"assets/checkout.js","sourcesContent":["__webpack_public_path__ = window.ORW.appUrl.replace(/assets\\/$/, '');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../\";","const __WEBPACK_NAMESPACE_OBJECT__ = jQuery;","let subscribers = {};\n\nexport const PUB_SUB_EVENTS = {\n    cartUpdate: 'cart-update', //The cart has been updated\n    variantOptionsChange: 'variant-options-change', //A product option was selected (but not necessarily a variant change)\n    variantChange: 'variant-change', //The product form has a new variant selected\n    cartError: 'cart-error', //There was an error updating the cart\n};\n\nexport function subscribe(eventName, callback) {\n    if (subscribers[eventName] === undefined) {\n        subscribers[eventName] = [];\n    }\n\n    subscribers[eventName] = [...subscribers[eventName], callback];\n\n    return function unsubscribe() {\n        subscribers[eventName] = subscribers[eventName].filter((cb) => {\n            return cb !== callback;\n        });\n    };\n}\n\nexport function publish(eventName, data) {\n    if (subscribers[eventName]) {\n        subscribers[eventName].forEach((callback) => {\n            callback(data);\n        });\n    }\n}","import './public-path';\n\nimport '../styles/checkout.scss';\nimport OneMarketing from '@/modules/module-oneMarketing';\n\nif (ORW.enableGTM) {\n    ORW.marketing = ORW.marketing || new OneMarketing;\n    ORW.marketing.checkoutEvents();\n}","/*\n\tOneMarketing\n\tjwerner@onerockwell\n\tDescription: This module manages custom event dataLayer sends to Google Tag Manager (GTM).  \n\tData is formatted for Google Analytics 4 (GA4),\n\t\tand the events match basic / recommended GA4 eCommerce events (prefixed with \"dl_\"). \n\t\tThe list of events is available in this module's gaEvents() getter function.\n\tEvent calls and snippet data to be included in other files where needed.  \n\t\tSee: https://docs.google.com/document/d/1VYAs2LofhDzl8OfkL__iiYmee-Pm91RetlYxUX3AsMo/\n\tTags and variables for these custom events need to be set up in GTM.  \n*/\nimport $ from 'jquery';\nimport { PUB_SUB_EVENTS, subscribe } from '@/lib/pubsub';\n\nexport default class OneMarketing {\n\tconstructor () {\n\t\tthis.settings = ORW.marketingSettings || '';\n\n\t\tconsole.log('init marketing');\n\t\t/*\n\t\t\tsettings = {\n\t\t\t\t// Used internally & externally (GTM needs access):\n\t\t\t\tpromoParentClass: string, // Class name applied for view_promotion when sent via GTM\n\t\t\t\tdataAttributePromo: string, // Data attribute applied to ga4-promo-data items\n\t\t\t\tcartCurrency: string, // Currency code to send along with cart / item values\n\t\t\t}\n\n\t\t\t// Used internally:\n\t\t\ttrackPromosViaDataLayer: boolean, // If true: send view_promotion event via dataLayer\n\t\t\tcustomSearchEvent: boolean, // If true: send search event in addition to default Enhanced Measurement\n\t\t\tdataAttributeItem: string, // Data attribute applied to ga4-item-data items\n\t\t\tproductPageSelector: string, // CSS parent selector of PDP snippet\n\t\t\tcartPageSelector: string, // CSS parent selector of cart page snippet\n\t\t\tsignUpFormID: string // ID of sign up / register account form\n\t\t*/\n\n\t\tthis.trackPromosViaDataLayer = false;\n\t\tthis.customSearchEvent = false;\n\t\tthis.dataAttributeItem = '[data-ga-item-json]';\n\t\tthis.productPageSelector = '.product-core';\n\t\tthis.cartPageSelector = '.cart-item';\n\t\tthis.signUpFormID = 'create_customer';\n\n\t\tthis.promoParentClass = this.settings.promoParentClass || 'ga-promo-element';\n        this.dataAttributePromo = this.settings.dataAttributePromo || '[data-ga-promo-json]';\n\t\tthis.cartCurrency = this.settings.cartCurrency || '';\n    }\n\n\t/* \n\t\t--- GTM events / dataLayer functions ---\n\t*/\n\n\tget gaEvents() {\n\t\t// Custom GTM trigger event names\n\t\treturn {\n\t\t\tadd_to_cart: \"dl_add_to_cart\",\n\t\t\tremove_from_cart: \"dl_remove_from_cart\",\n\t\t\tview_cart: \"dl_view_cart\",\n\t\t\tbegin_checkout: \"dl_begin_checkout\",\n\t\t\tadd_shipping_info: \"dl_add_shipping_info\",\n\t\t\tadd_payment_info: \"dl_add_payment_info\",\n\t\t\tview_item_list: \"dl_view_item_list\",\n\t\t\tview_item: \"dl_view_item\",\n\t\t\tview_promotion: \"dl_view_promotion\",\n\t\t\tselect_promotion: \"dl_select_promotion\",\n\t\t\tadd_to_wishlist: \"dl_add_to_wishlist\",\n\t\t\tsearch: \"dl_search\",\n\t\t\tsign_up: \"dl_sign_up\"\n\t\t}\n\t}\n\n\tdataLayerPush (eventString, ecommerceObject) {\n\t\twindow.dataLayer = window.dataLayer || [];\n\t\twindow.dataLayer.push({ ecommerce: null });\n\t\twindow.dataLayer.push({\n\t\t\tevent: eventString,\n\t\t\tecommerce: ecommerceObject\n\t\t});\n\t}\n\n\t/* \n\t\t--- Event watcher functions --- \n\t*/\n\n\t/* --- Cart events: add & remove from cart --- */\n\tinitCartWatchers() {\n\t\t// Click \"X\" to remove all quantities of item\n\t\t$('.cart-items').on('click', '.item-remove', (e) => {\n\t\t\tthis.removeFromCart(e.currentTarget);\n\t\t});\n\n\t\t// Click plus / minus or edit quantity number directly\n\t\tlet timer;\n\t\t$('.cart-items').on('change', '[data-cart-quantity]', (e) => {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\tthis.checkItemQtyChangeCart(e);\n\t\t\t}, 500);\n\t\t});\n\t}\n\n\t/* --- Update variant info when swatch changed --- */\n\tinitVariantWatcher (productCore) {\n\t\tsubscribe(PUB_SUB_EVENTS.variantChange, (variant) => {\n\t\t\tlet newVariant = variant.id;\n\t\t\tlet gaData = $(productCore).find(this.dataAttributeItem);\n\t\t\t\n\t\t\tgaData.data('ga-variant-id', newVariant);\n\t\t});\n\t}\n\n\t/* --- Wishlist event: add to wishlist --- */\n\tinitWishlistWatcher () {\n\t\t// Item added to wishlist default event: update as needed to work with wishlist app\n\t\t$(document.body).on('click', '.add-to-wishlist', (e) => {\n\t\t\tthis.addToWishlist(e.target);\n\t\t})\n\t}\n\n\t/* --- Featured promotion events (using ga4-promo-data snippet): view & select --- */\n\tinitPromoWatchers () {\n\t\tconst $promos = $(this.dataAttributePromo);\n\n\t\t$promos.each((index, promo) => {\n\t\t\tconst ecommerceObject = this.__parseItemJSON(promo);\n\n\t\t\tif (ecommerceObject) {\n\t\t\t\tconst $promoParent = $(promo).parent();\n\t\t\t\tconst hasClick = $(promo).data('ga-promo-click');\n\n\t\t\t\tif (this.trackPromosViaDataLayer) {\n\t\t\t\t\tthis.viewPromo(ecommerceObject);\n\t\t\t\t} else {\n\t\t\t\t\t// GTM element visibility selector\n\t\t\t\t\t$promoParent.addClass(this.promoParentClass);\n\t\t\t\t}\n\n\t\t\t\tif (hasClick) {\n\t\t\t\t\tlet clickTarget = $promoParent;\n\t\t\t\t\tif (hasClick !== true) {\n\t\t\t\t\t\tclickTarget = $promoParent.find(hasClick);\n\t\t\t\t\t};\n\t\t\t\t\tthis.selectPromo(clickTarget, ecommerceObject);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\t/* \n\t\t--- GTM Event functions --- \n\t*/\n\n\t/* --- Promotion events --- */\n\tviewPromo (ecommerceObject) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tpromotion_id: string,\n\t\t\t\tpromotion_name: string,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.view_promotion;\n\n\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t}\n\n\tselectPromo (promo, ecommerceObject) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tpromotion_id: string,\n\t\t\t\tpromotion_name: string,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.select_promotion;\n\n\t\t$(promo).one('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t\tthis.__triggerButtonOrLink(e.target);\n\t\t});\n\t}\n\n\t/* --- Product / PDP events --- */\n\tviewItem (productCore) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.view_item;\n\n\t\tconst itemData = this.__getItemDataFromJSON(productCore);\n\n\t\tif (itemData) {\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromItem(itemData);\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\t/* --- Default wishlist event; update to work with wishlist app --- */\n\taddToWishlist (eventTarget) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.add_to_wishlist;\n\n\t\tconst $productCore = $(eventTarget).parents(this.productPageSelector);\n\t\tconst itemData = this.__getItemDataFromJSON($productCore);\n\n\t\tif (itemData) {\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromItem(itemData);\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\t/* --- PLP / Search events --- */\n\tviewItemList (collection, items) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\titem_list_id: string,\n\t\t\t\titem_list_name: string,\n\t\t\t\titems: array,\n\t\t\t\t(item additional info: index)\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.view_item_list;\n\n\t\tconst itemListID = collection.data('ga-id');\n\t\tconst itemListName = collection.data('ga-name');\n\t\tlet itemsArray = this.__createListItemsArray(items);\n\n\t\tconst searchQuery = ORW.utilities.getUrlParam(window.location.href,'q');\n\t\tif (searchQuery && this.customSearchEvent) {\n\t\t\tthis.search(searchQuery);\n\t\t}\n\n\t\tif (itemsArray.length > 0) {\n\t\t\tconst ecommerceObject = {\n\t\t\t\titem_list_id: itemListID,\n\t\t\t\titem_list_name: itemListName,\n\t\t\t\titems: itemsArray,\n\t\t\t}\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\tsearch (query) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tsearch_term: string\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.search;\n\t\tconst formattedQuery = query.replace('+', ' ');\n\n\t\tconst ecommerceObject = {\n\t\t\tsearch_term: formattedQuery, \n\t\t}\n\n\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t}\n\n\t/* --- Account events --- */\n\tsignUp () {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tmethod: string\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.sign_up;\n\t\t\n\t\tconst ecommerceObject = {\n\t\t\tmethod: 'Shopify', \n\t\t}\n\n\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t}\n\n\taccountForm (form) {\n\t\tif ($(form).attr('id') === this.signUpFormID) {\n\t\t\tthis.signUp();\n\t\t}\n\t}\n\n\t/* --- Cart page non-Ajax events --- */\n\tremoveFromCart (eventTarget) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.remove_from_cart;\n\n\t\tconst $clickedItem = $(eventTarget).parents(this.cartPageSelector);\n\t\tconst itemData = this.__getItemDataFromJSON($clickedItem);\n\n\t\tif (itemData) {\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromItem(itemData);\n\t\t\t// Removing an item; value == negative\n\t\t\tecommerceObject.value = ecommerceObject.value * -1;\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\tasync viewCart () {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.view_cart;\n\n\t\tconst cart = await this.__getCart();\n\t\tif (cart) {\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromCart(cart);\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\tcheckItemQtyChangeCart (event) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tlet input = event.currentTarget;\n\t\tlet quantity = this.__preferNumber(input.value);\n\t\tlet originalQuantity = this.__preferNumber(input.defaultValue);\n\t\tlet diff = quantity - originalQuantity;\n\n\t\tlet parent = $(input).parents(this.cartPageSelector);\n\t\tlet itemData = this.__getItemDataFromJSON(parent);\n\n\t\tif (itemData) {\n\t\t\titemData.quantity = Math.abs(diff);\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromItem(itemData);\n\t\t\tlet gaEvent;\n\n\t\t\tif (diff > 0) { // Quantity increased\n\t\t\t\tgaEvent = this.gaEvents.add_to_cart;\n\t\t\t} else if (diff < 0) { // Quantity decreased\n\t\t\t\tgaEvent = this.gaEvents.remove_from_cart;\n\t\t\t\tecommerceObject.value = ecommerceObject.value * -1;\n\t\t\t}\n\n\t\t\tif (gaEvent) {\n\t\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckItemQtyManualChangeCartPage () {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst quantityInputs = $('input.js-qty__num');\n\t\tlet itemsAdded = [];\n\t\tlet itemsRemoved = [];\n\t\tlet totalValueAdded = 0;\n\t\tlet totalValueRemoved = 0;\n\n\t\tfor (let input of quantityInputs) {\n\t\t\tconst item = $(input).parents(this.cartPageSelector);\n\t\t\tconst itemData = this.__getItemDataFromJSON(item);\n\t\t\tconst itemQuantity = this.__preferNumber($(input).val());\n\n\t\t\tif (itemData && itemData.quantity !== itemQuantity) {\n\t\t\t\tconst qtyDiff = itemQuantity - itemData.quantity;\n\t\t\t\titemData.quantity = Math.abs(qtyDiff);\n\t\t\t\tconst valueChange = itemData.price * itemData.quantity;\n\t\t\t\tif (qtyDiff > 0) {\n\t\t\t\t\t// Items added\n\t\t\t\t\ttotalValueAdded += valueChange;\n\t\t\t\t\titemsAdded.push(itemData);\n\t\t\t\t} else {\n\t\t\t\t\t// Items removed\n\t\t\t\t\ttotalValueRemoved -= valueChange;\n\t\t\t\t\titemsRemoved.push(itemData);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (itemsAdded.length > 0) {\n\t\t\tconst gaEvent = this.gaEvents.add_to_cart;\n\t\t\tconst ecommerceObject = {\n\t\t\t\t\"currency\": this.cartCurrency,\n\t\t\t\t\"value\": totalValueAdded,\n\t\t\t\t\"items\": itemsAdded,\n\t\t\t};\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\n\t\tif (itemsRemoved.length > 0) {\n\t\t\tconst gaEvent = this.gaEvents.remove_from_cart;\n\t\t\tconst ecommerceObject = {\n\t\t\t\t\"currency\": this.cartCurrency,\n\t\t\t\t\"value\": totalValueRemoved,\n\t\t\t\t\"items\": itemsRemoved,\n\t\t\t};\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\taddToCart (form) {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\tconst gaEvent = this.gaEvents.add_to_cart;\n\n\t\tlet quantity = 1; // Default qty\n\t\tlet $formQtyInput = $(form).find('input.qty-input');\n\n\t\tif ($formQtyInput.length > 0) {\n\t\t\tquantity = $formQtyInput.val();\n\t\t}\n\n\t\tlet parent = $(form).parents(this.productPageSelector);\n\t\tlet itemData = this.__getItemDataFromJSON(parent);\n\n\t\tif (itemData) {\n\t\t\titemData.quantity = this.__preferNumber(quantity);\n\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromItem(itemData);\n\n\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t}\n\t}\n\n\t/* --- Checkout events --- */\n\tasync checkoutEvents () {\n\t\t/* \n\t\t\tdataLayer object format:\n\t\t\t{\n\t\t\t\tcurrency: string,\n\t\t\t\tvalue: number,\n\t\t\t\titems: array\n\t\t\t}\n\t\t*/\n\t\t// Checkout page events & associated GTM trigger\n\t\tconst checkoutTriggers = {\n\t\t\t'contact_information': this.gaEvents.begin_checkout,\n\t\t\t'shipping_method': this.gaEvents.add_shipping_info,\n\t\t\t'payment_method': this.gaEvents.add_payment_info,\n\t\t}\n\n\t\tif (window.Shopify && window.Shopify.Checkout) {\n\t\t\tconst currentStep = window.Shopify.Checkout.step;\n\t\t\tif (currentStep) {\n\t\t\t\tconst gaEvent = checkoutTriggers[currentStep];\n\n\t\t\t\tif (gaEvent) {\n\t\t\t\t\tconst cart = await this.__getCart();\n\n\t\t\t\t\tif (cart) {\n\t\t\t\t\t\tconst ecommerceObject = this.__createEcommerceObjectFromCart(cart);\n\t\t\t\t\t\tecommerceObject.coupon = $('[data-ga-checkout-coupons]').html() || '';\n\n\t\t\t\t\t\tthis.dataLayerPush(gaEvent, ecommerceObject);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t/* --- Purchase event in ga4-checkout-script.liquid --- */\n\n\t/* \n\t\t--- Helper & format functions --- \n\t*/\n\t\n\t/* --- Cart fetch for cart & checkout events --- */\n\tasync __getCart () {\n        let cartResponse,\n\t\tcartContents;\n\n        try {\n            cartResponse = await fetch('/cart.js');\n        } catch (e) {\n            console.error(e);\n        }\n\n\t\tif (cartResponse?.ok) {\n\t\t\tcartContents = await cartResponse.json();\n\t\t}\n\n\t\treturn cartContents;\n    }\n\n\t__getItemDataFromJSON (item) {\n\t\t// Translate parsed JSON into dataLayer-formatted item object\n\t\tconst jsonData = this.__getItemJSON(item);\n\t\tconst parsedData = this.__parseItemJSON(jsonData);\n\t\tlet formattedData;\n\n\t\tif (parsedData) {\n\t\t\tconst variantID = jsonData.data('ga-variant-id');\n\t\t\tif (variantID) {\n\t\t\t\t// Product data\n\t\t\t\tformattedData = this.__getProductInfo(parsedData, this.__preferNumber(variantID));\n\t\t\t} else {\n\t\t\t\t// Cart data\n\t\t\t\tformattedData = this.__getItemInfo(parsedData);\n\t\t\t}\n\t\t}\n\n\t\treturn formattedData;\n\t}\n\n\t__parseItemJSON (json) {\n\t\tconst jsonInner = $(json).html();\n\t\tlet jsonParsed;\n\n\t\ttry {\n\t\t\tjsonParsed = JSON.parse(jsonInner);\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t\treturn jsonParsed;\n\t}\n\t\n\t__getItemJSON (item) {\n\t\t// Find the JSON data in the DOM\n\t\tconst $itemJSON = $(item).find(this.dataAttributeItem);\n\n\t\tif ($itemJSON.length > 0) {\n\t\t\treturn $itemJSON;\n\t\t} else {\n\t\t\treturn item;\n\t\t}\n\t}\n\t\n\t/* --- Single item event, like add to cart, view item, etc. --- */\n\t__createEcommerceObjectFromItem (item) {\n\t\tconst priceFormatted = item.price * item.quantity;\n\n\t\tconst ecommerceObject = {\n\t\t\t\"currency\": this.cartCurrency,\n\t\t\t\"value\": this.__preferNumber(priceFormatted),\n\t\t};\n\n\t\tecommerceObject.items = [item];\n\n\t\treturn ecommerceObject;\n\t}\n\n\t/* --- Multi-item event specific to cart, like view cart, checkout, etc. --- */\n\t__createEcommerceObjectFromCart (cart) {\n\t\tconst priceFormatted = this.__formatPrice(cart.total_price);\n\n\t\tconst ecommerceObject = {\n\t\t\t\"currency\": cart.currency || this.cartCurrency,\n\t\t\t\"value\": this.__preferNumber(priceFormatted),\n\t\t};\n\n\t\tecommerceObject.items = this.__createCartItemsArray(cart);\n\n\t\treturn ecommerceObject;\n\t}\n\n\t/* --- Cart item-specific: get and format line item data that will be used within items: [] array --- */\n\t__getItemInfo (item) {\n\t\tconst priceFormatted = this.__formatPrice(item.final_price);\n\t\tconst discountFormatted = this.__formatPrice(item.line_level_total_discount);\n\t\tconst coupons = this.__getItemCoupons(item);\n\n\t\tconst gaFormattedItem = {\n\t\t\t'item_id': item.sku,\n\t\t\t'item_name': item.product_title,\n\t\t\t'item_brand': item.vendor,\n\t\t\t'item_category': item.product_type,\n\t\t\t'item_variant': item.variant_title,\n\t\t\t'price': this.__preferNumber(priceFormatted),\n\t\t\t'quantity': this.__preferNumber(item.quantity),\n\t\t\t'affiliation': item.selling_plan_allocation_selling_plan_name || '',\n\t\t\t'coupon': coupons,\n\t\t\t'discount': this.__preferNumber(discountFormatted)\n\t\t};\n\n\t\treturn gaFormattedItem;\n\t}\n\n\t/* --- Product-specific: get and format variant data that will be used within items: [] array --- */\n\t__getProductInfo (product, variantID) {\n\t\tlet variant = product;\n\t\tfor (const prodVariant of product.variants) {\n\t\t\tif (prodVariant.id === variantID) {\n\t\t\t\tvariant = prodVariant;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst priceFormatted = this.__formatPrice(variant.price);\n\t\t\n\t\tconst gaFormattedProduct = {\n\t\t\t'item_id': variant.sku,\n\t\t\t'item_name': product.title,\n\t\t\t'item_brand': product.vendor,\n\t\t\t'item_category': product.type,\n\t\t\t'item_variant': variant.title,\n\t\t\t'price': this.__preferNumber(priceFormatted),\n\t\t\t'quantity': 1,\n\t\t\t'affiliation': '',\n\t\t\t'coupon': '',\n\t\t\t'discount': 0\n\t\t};\n\n\t\treturn gaFormattedProduct;\n\t}\n\n\t__createCartItemsArray (cart) {\n\t\tlet itemsArray = [];\n\n\t\tfor (let item of cart.items) {\n\t\t\tconst newProduct = this.__getItemInfo(item);\n\t\t\titemsArray.push(newProduct);\n\t\t};\n\n\t\treturn itemsArray;\n\t}\n\n\t__createListItemsArray (items) {\n\t\tlet itemsArray = [];\n\n\t\tfor (let item of items) {\n\t\t\tif (item.classList.contains('promo')) {\n\t\t\t\t// Exclude promo banners\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst itemData = this.__getItemDataFromJSON(item);\n\t\t\tif (itemData) {\n\t\t\t\tconst index = $(item).data('product-index');\n\t\t\t\titemData.index = this.__zeroBasedIndex(index);\n\n\t\t\t\titemsArray.push(itemData);\n\t\t\t}\n\t\t}\n\n\t\treturn itemsArray;\n\t}\n\n\t__getItemCoupons (item) {\n\t\tlet coupons = [];\n\t\tconst discounts = item.line_level_discount_allocations;\n\n\t\tif (discounts) {\n\t\t\tfor (let coupon of discounts) {\n\t\t\t\tconst couponName = coupon.discount_application.title.trim();\n\t\t\t\tcoupons.push(couponName);\n\t\t\t}\n\t\t}\n\t\treturn coupons.join(\", \");\n\t}\n\n\t__triggerButtonOrLink (eventTarget) {\n\t\tconst targetLink = $(eventTarget).children().attr('href');\n\n\t\tif (targetLink) {\n\t\t\tlocation.href = targetLink;\n\t\t} else {\n\t\t\teventTarget.click();\n\t\t}\n\t}\n\n\t__zeroBasedIndex (index) {\n\t\tconst zeroedIndex = this.__preferNumber(index) - 1;\n\t\treturn zeroedIndex;\n\t}\n\n\t__preferNumber (input) {\n\t\t// Standard JS, trailing zeroes will not be retained\n\t\tconst converted = Number(input) || input;\n\t\treturn converted;\n\t}\n\n\t__formatPrice (price) {\n\t\t// Convert Shopify's price result to decimal\n\t\tlet priceFormatted = price ? price / 100 : '';\n\n\t\tif (priceFormatted === '') {\n\t\t\tpriceFormatted = 0;\n\t\t}\n\n\t\treturn priceFormatted;\n\t}\n\t// end helper / format functions\n}"],"sourceRoot":""}